\documentclass[a4paper]{article}

\usepackage{geometry}
\geometry{verbose,tmargin=30mm,bmargin=30,lmargin=25,rmargin=20}
\title{DSMcompare: Analysis of digital surface models by using non-parametric statistics}
\author{Thomas Naake}

\usepackage{Sweave}
\begin{document}

\maketitle

\begin{Schunk}
\begin{Sinput}
> library(maptools)
> mM <- c("/home/thomas/Documents/University/Bachelor/FVA/Daten/Messpunkte/Messpunkte_Petra1.shp",
+         "/home/thomas/Documents/University/Bachelor/FVA/Daten/Messpunkte/Messpunkte_Petra2.shp",
+         "/home/thomas/Documents/University/Bachelor/FVA/Daten/Messpunkte/Messpunkte_Petra3.shp")
\end{Sinput}
\end{Schunk}
Read manual measurements
\begin{Schunk}
\begin{Sinput}
> lmM <- readManualMeasure(files = mM)
\end{Sinput}
\end{Schunk}

cut data
\begin{Schunk}
\begin{Sinput}
> cmM <- cutData(uncutfiles = list(lmM[[1]], lmM[[2]]), 
+                columns = list("x_coord" = 9, "y_coord" = 10, "z_coord" = 6, "class" = 3),
+                omit.class = FALSE)
\end{Sinput}
\end{Schunk}

Calculate means of cut manual measure
\begin{Schunk}
\begin{Sinput}
> mcmM <- meanManualMeasure(manualMeasure = cmM)
\end{Sinput}
\end{Schunk}

Read model values
\begin{Schunk}
\begin{Sinput}
> coordinatesModel <- mcmM[, 1:2]
> MTb1 <- read.table(file = "/home/thomas/Documents/University/Bachelor/FVA/Daten/Models/MT_balanced1_buf5m.txt", sep = ";")
> MTb2 <- read.table(file = "/home/thomas/Documents/University/Bachelor/FVA/Daten/Models/MT_balanced2_buf5m.txt", sep = ";")
> MTb3 <- read.table(file = "/home/thomas/Documents/University/Bachelor/FVA/Daten/Models/MT_balanced3_buf5m.txt", sep = ";")
> cModh <- calcModelHeights(coordinates = coordinatesModel, model = list(MTb1 = MTb1, MTb2 = MTb2, MTb3 = MTb3),
+                           method = "IDW",
+                           idw = list("p" = 2, "m" = 5, "rad" = 5))
\end{Sinput}
\begin{Soutput}
[1] "model MTb1: 1 / 3"
[1] "model MTb2: 2 / 3"
[1] "model MTb3: 3 / 3"
\end{Soutput}
\end{Schunk}

Calculate error between manual measure and model values

\begin{Schunk}
\begin{Sinput}
> errorMod <- errorModel(manual = mcmM, model = cModh)
\end{Sinput}
\end{Schunk}

Test if errors are normally distributed
\begin{Schunk}
\begin{Sinput}
> errorNormalTest(errorMod, hist = TRUE, ksTest = FALSE, qq = FALSE, classes = FALSE)
\end{Sinput}
\begin{Soutput}
[1] "MTb1"
[1] "MTb2"
[1] "MTb3"
\end{Soutput}
\end{Schunk}

Calculate parameter-free statistic values
\begin{Schunk}
\begin{Sinput}
> statValues <- stat(errorMod, cfi = FALSE, classes = FALSE)
\end{Sinput}
\end{Schunk}

Plot 

\begin{Schunk}
\begin{Sinput}
> plotStats(statValues, param = c("NMAD", "median", "max|h|"))
\end{Sinput}
\end{Schunk}






\end{document}
